name: "aws-exe-docker-build"

on:
  push:
    branches:
      - main
  workflow_dispatch:
    inputs:
      rt_npm_remote_repo_id:
        required: true
        type: string
        default: "expressjs-npm-remote"
        description: "Artifactory Repository Name"
      rt_npm_curation_remote_repo_id:
        required: true
        type: string
        default: "expressjs-npm-remote"
        description: "NPM Curation Repository Name"
      rt_docker_repo:
        required: true
        type: string
        default: "expressjs-docker-local"
        description: "Artifactory Docker repository"
      docker_image_name:
        required: true
        type: string
        default: "aws-exe-image"
        description: "Docker Image name"
      xr_enable_scan:
        required: true
        type: string
        default: "false"
        description: "Scan with Xray"
      curation_audit:
        required: true
        type: string
        default: "false"
        description: "Audit with Curation"
      xr_override_fail_build:
        required: true
        type: string
        default: "false"
        description: "Set to false to ignore the fail build coming from Xray (exit code 3)"
      cli_log_level:
        required: true
        type: string
        default: "INFO"
        description: "Set JFrog CLI Log level"

permissions:
  actions: read
  id-token: write
  packages: write
  contents: read
  security-events: write

jobs:
  build:
